---
layout: post
title:  "Seasonal adjustment of Mexico's homicide database"
date:   2013-07-02 13:17:15
categories: jekyll update
---

<p align="justify"> For the past few months or so I've been playing around with Mexicos's homicide database. Every month (around the 15th) the national public safety system <a href="http://www.secretariadoejecutivo.gob.mx/">(SNSP)</a> releases information regarding the number of crimes commited in Mexico, this information comes from the local (state) district attorney's office who compile information about the number of crimes commited for something like 10 or so different fellonies and then submit it to the SNSP who publishes the data at the state and national level. </p>

<p align="justify">Due to the constant release of data, this particular database proves particularly useful for government reporting about the state of public safety in the country for a particular month. Nevertheless consecutive month comparison may not be possible because not all months are created equal (I'll explain further in the next paragraphs). So <a href="http://www.twitter.com/ahope71" target="_blank">Alejandro Hope (follow him on twitter!!) </a> and me at IMCO decided it could be good idea to create a database that we could compare easily with any other month of the database (which runs from 1997 to the present). We chose to focus our efforts on the homicide (intentional) time series. We chose this particular series for a couple of very simple reasons. Homicide is probably the crime with the lowest under reportment rate (which should in theory also render it the most consistent in the database), and it's certainly the most serious crime, which should then help us assess the state of public safety better than the other available crimes. </p>

<p align="justify"> First of all, why should we expect marked monthly differences in crime rates? Well the first reason is that different months have a different number of days. So, even at the same rate of homicides per day, consecutive months can vary around 3% without real changes in the underlying situation. This is even more serious in the case of February which, at current numbers, can have about 150 more homicides than January or March at the same average number of homicides per day. But then, why not use average homicides per day as our benchmark? Well it might also be that the number of days per month doesn't tell the whole story.</p>

<p align="justify"> Seasonal Factors </p>

<p align="justify"> We knew of a series of techniques that are used to remove these ciclical factors from time series, this is a procedure known as <a href="http://en.wikipedia.org/wiki/Seasonal_adjustment" target="blank"> seasonal adjustment</a>. But before actually getting to the adjustment phase we had to inspect the series to look for marked differences between months, so we built a seasonal factors graph by period. This graph helps us see how the number of homicides for a particular month varies from the yearly mean and also how this variation changes over time. Meaning that for example, on average, May is has about 10% more homicides than the yearly average and February around 10% less. </p>

<img src="/Frames/SFactors.png">

<p align="justify"> This hints at the often mentioned Summer Effect theory in which summer months are likely to have higher criminal incidence statistics rates. As we can see in the previous graph, the months between May and August all show substancially higher numbers than average figures. On the contrary the colder months (November, December, January and February) of the year show clearly numbers than the rest of the year. This, and several statistical tests for seasonality, convinced us that the intentional homicide time series showed seasonality. So our next step was to adjust the series to remove those cyclical effects.</p>


<p align="justify"> Presently the two most commonly used seasonal adjustment methods are <a href="http://www.census.gov/srd/www/x12a/" target="_blank">X-13 Arima</a>, developed by the U.S. Census Bureau, and <a href="http://www.bde.es/bde/es/secciones/servicios/Profesionales/Programas_estadi/Programas_estad_d9fa7f3710fd821.html" target="_blank">TRAMO/SEATS</a>, which was developed by Spain's central bank. These two are basically a series of econometric procedures that are applied to the original series that output three new series. A trend series, a seasonal component series and an irregular component series (there is also a cyclical component for longer runs). Basically any time series can be disagregated into these components and the sum of the three will yield the original series. In it's most basic form the seasonal component only includes that part of the series that comes from the seasonal effect. The trend component describes the basic inertia of the series and resembles somehow a moving average in that it greatly smooths the series behavior. Finally the irregular component includes those parts of the series that could be considered as shocks, for example the <a href="https://en.wikipedia.org/wiki/2011_San_Fernando_massacre">San Fernando Massacre</a> in April 2011 that included nearly 200 homicides in a single event, which can greatly impact the series but don't necessarly alter the underlying trend. So if we remove that seasonal component from the original series we would come up with a seasonaly adjusted series and the observations in this new series can be compared with any other month of the series, a bit like inflation adjustment. </p>

<p align="justify"> These two methods, X-13-Arima and TRAMO/SEATS, are quite similar and also produce quite similar results. In the past my method of choice had been TRAMO/SEATS (via <a href="http://gretl.sourceforge.net/gretl_espanol.html">Gretl</a>) but that often required me to use multiple software usually by the way of cumbersome shell scripts. So when I heard about a new R package (my weapon of choice) that linked X-13 and R I decided to switch to that. While the installation and linking can be a bit of hassle the package runs smoothly and having everything in the same workspace speeds up the analysis. So after quite a while picking the most appropiate model specification (complete code in my GitHub) we end up with the seasonally adjusted time series. </p>

<img src="/Frames/New.png">

<p align="justify"> The previous graph shows the combination of the 3 series; original, seasonally adjusted and trend series. It's easy to see that perhaps the main advantage of such graph is that we can see interesting months easily. For example 2011, the most dire period in our public safety crisis. The year started out with what in the original series would have been seen as a decreasing number of homicides but as the summer came about those figures spiraled up upwards of 2,000 homicides per months, when we include the seasonally adjusted and trend series we can see that the reduction in February and March was mostly due to seasonal effects and the huge bump in April, May and June was also mostly normal, meaning that while the number of homicides per month was on the rise, the real slope wasn't as steep as it seemed. </p>




